<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React &middot; John Palgut</title>

    <meta name="description" content="Coder. Gamer. Husband.">

    <meta name="generator" content="Hugo 0.15-DEV" />
    <meta name="twitter:card" content="summary">
    
    <meta name="twitter:title" content="React &middot; John Palgut">
    <meta name="twitter:description" content="Coder. Gamer. Husband.">

    <meta property="og:type" content="article">
    <meta property="og:title" content="React &middot; John Palgut">
    <meta property="og:description" content="Coder. Gamer. Husband.">

    <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Oxygen:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
    <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
    <!--<![endif]-->

    <link rel="stylesheet" href="http://localhost:1313//css/all.min.css">
    <link rel="stylesheet" href="http://localhost:1313//css/main.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

    <link rel="alternate" type="application/rss+xml" title="John Palgut" href="http://localhost:1313//index.xml" />
</head>
<body>


<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
    <div class="header">
        <hgroup>
            <h1 class="brand-title"><a href="http://localhost:1313/">John Palgut</a></h1>
            <h2 class="brand-tagline"> Coder. Gamer. Husband. </h2>
        </hgroup>

        <nav class="nav">
            <ul class="nav-list">
                <li class="nav-item">
                    <a class="pure-button" href="/pdf/resume.pdf"><i class="fa fa-file-text-o"></i> Resume</a>
                </li>
                <li class="nav-item">
                    <a class="pure-button" href="/projects"><i class="fa fa-folder-open-o"></i> Projects</a>
                </li>
                <li class="nav-item">
                    <a class="pure-button" href="/about"><i class="fa fa-male"></i> About Me</a>
                </li>
            </ul>
        </nav>

        <nav class="nav">
            <ul class="nav-list">
                
                <li class="nav-item">
                    <a class="pure-button" target="_blank" href="https://twitter.com/jwsonic"><i class="fa fa-twitter"></i> Twitter</a>
                </li>
                
                
                <li class="nav-item">
                    <a class="pure-button" target="_blank" href="https://github.com/Jwsonic "><i class="fa fa-github-alt"></i> github</a>
                </li>
                
                
            </ul>
        </nav>
    </div>
</div>


    <div class="content pure-u-1 pure-u-md-3-4">
        <div>
            
            <div class="posts">
                
                <h1 class="content-subhead">01 Sep 2015, 14:47</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://localhost:1313/projects/filegrabber/" class="post-title">File Grabber</a>

                        <p class="post-meta">
                            
                            
                                under
                                
                                <a class="post-category post-category-HTML" href="http://localhost:1313//categories/html">HTML</a><a class="post-category post-category-Go" href="http://localhost:1313//categories/go">Go</a><a class="post-category post-category-React" href="http://localhost:1313//categories/react">React</a><a class="post-category post-category-Bootstrap" href="http://localhost:1313//categories/bootstrap">Bootstrap</a><a class="post-category post-category-websockets" href="http://localhost:1313//categories/websockets">websockets</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        

<h2 id="the-why:5d4b5b538fe8b07ed03522cce78aaef9">The why</h2>

<p>There is a small server in our apartment that my wife and I use to back-up photos and documents. The server runs Ubuntu and it&rsquo;s pretty easy to access our files through FTP or SSH. However, sometimes we like to download photos or files to our mobile devices and most Android FTP clients are cumbersome or lacking features. After a bit of research, I found <a href="https://github.com/itang/gohttp">gohttp</a>, which is very close to what we wanted, but not quite. I took this as an opportunity to build a webapp similar to gohttp that would fit our exact needs and allow me to learn some new tricks along the way.</p>

<h2 id="requirements:5d4b5b538fe8b07ed03522cce78aaef9">Requirements</h2>

<p>The initial requirements for File Grabber were:</p>

<ul>
<li>ability to view, download, and delete files and folders</li>
<li>real-time updates (i.e. if a file is deleted on the server, it is immediately removed from the browser)</li>
<li>single binary installation like gohttp</li>
<li>has to run on Ubuntu</li>
<li>be fully <a href="https://en.wikipedia.org/wiki/Responsive_web_design">responsive</a></li>
</ul>

<!--
## Behind every good developer is a designer

Jes designed stuff. Show design mocks here. -->

<h2 id="front-end-with-react-and-redux:5d4b5b538fe8b07ed03522cce78aaef9">Front end with React and Redux</h2>

<p>After using <a href="https://facebook.github.io/react/">React</a> to build <a href="/projects/playbook/#using-react-for-an-easy-to-understand-ui:ae2e17d81343b352e5f8570697d79589">The Playbook</a> it has quickly become my favorite way to build webapp front ends. One thing React is not designed for is managing your application state. Facebook (the creator of React) recommends using the <a href="https://facebook.github.io/flux/">Flux</a> architecture for React apps. When I did more research on Flux, I found out that there are <a href="https://github.com/voronianski/flux-comparison">many flux implementations</a> to choose from. Eventually I decided to use a method similar to Flux called <a href="http://rackt.github.io/redux/">Redux</a>. Redux, in its own words, is &ldquo;<a href="http://rackt.github.io/redux/">&hellip;a predictable state container for JavaScript apps.</a>&rdquo;.</p>

<p>The core idea behind Redux is that your application state is stored as a read only data structure. Updates to application state are done via <a href="https://en.wikipedia.org/wiki/Pure_function">pure functions</a> called reducers. Reducers take a state and an action as parameters and return an updated application state:</p>

<pre><code>(state, action) =&gt; newState
</code></pre>

<p>A sample state for file grabber could look something like:</p>

<pre><code>{
  ui: {
    deleteModal: {
      open: true,
      fileName: 'photo.jpg'
    }
  },
  fileData: {
    files: [{
      name: 'photo.jpg',
      size: 100000
      modTime: 19219319191,
      isDir: false
      }],
    path: '/'
  },
  server: {
    connected: true
  }
}
</code></pre>

<h2 id="javascript-talking-to-go:5d4b5b538fe8b07ed03522cce78aaef9">JavaScript talking to Go</h2>

<p>In order to get updates in real-time, File Grabber uses <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API">WebSockets</a> to send messages between the front end in the browser and the back end on the server. When File Grabber is first loaded into the browser it attempts to connect to the File Grabber websocket server. Once a connection has been established between the front and back ends the message passing can begin. The back end will send CREATE/UPDATE/DELETE messages whenever changes are made to the watched folder. The front end will send DELETE/FILES messages to the server as the user interacts with the files in the UI.</p>

<h2 id="careful-inotify-is-watching-you:5d4b5b538fe8b07ed03522cce78aaef9">Careful, inotify is watching you</h2>

<p>Since only linux is currently supported for the File Grabber back end, we use <a href="https://en.wikipedia.org/wiki/Inotify">inotify</a> to watch the file system for changes. The Go standard library contains a <a href="https://godoc.org/golang.org/x/exp/inotify">wrapper for inotify</a>, but out of the box it doesn&rsquo;t watch folders recursively. Since the server is not aware of each browser&rsquo;s current path it needs to watch for changes at every level of the watched file tree.</p>

<p>To solve this problem I wrote my own wrapper of the Go inotify called RecursiveWatcher. RecursiveWatcher also simplifies inotify&rsquo;s events down to just Create, Modify, and Delete. Watching for file events on a RecursiveWatcher uses a Go channel just like the normal inotify wrapper. For instance, watching the current directory could look something like:</p>

<pre><code>rWatcher, _ := watcher.NewRecursiveWatcher(&quot;.&quot;)
events := rWatcher.Watch()

for {
  event := &lt;-events

  switch event.Type {
    case watcher.Delete:
      fmt.Printf(&quot;%s deleted\n&quot;, event.Name)
    case watcher.Modify:
      fmt.Printf(&quot;%s modified\n&quot;, event.Name)
    case watcher.Create:
      fmt.Printf(&quot;%s created\n&quot;, event.Name)
  }
}
</code></pre>

<h2 id="deploying-as-a-single-binary:5d4b5b538fe8b07ed03522cce78aaef9">Deploying as a single binary</h2>

<p><a href="https://github.com/jteeuwen/go-bindata">go-bindata</a> is an excellent library that takes a file or directory as input, compresses the data, and embeds the compressed bytes into a Go file. You can then access the compressed data through a function with the signature of <code>Asset(string) ([]byte, error)</code>. For File Grabber I used the compiled go-bindata command line tool to compress all the front end files into a single Go file. The data from this asset file is then served over HTTP as the front end.</p>

<h2 id="check-it-out:5d4b5b538fe8b07ed03522cce78aaef9">Check it out</h2>

<p>The code for file grabber is available on <a href="https://github.com/Jwsonic/file-grabber">github</a>.</p>

                    </div>
                </section>
                
                <h1 class="content-subhead">07 Jul 2015, 14:47</h1>
                <section class="post">
                    <header class="post-header">

                        <a href="http://localhost:1313/projects/playbook/" class="post-title">The Playbook</a>

                        <p class="post-meta">
                            
                            
                                under
                                
                                <a class="post-category post-category-HTML" href="http://localhost:1313//categories/html">HTML</a><a class="post-category post-category-React" href="http://localhost:1313//categories/react">React</a><a class="post-category post-category-webpack" href="http://localhost:1313//categories/webpack">webpack</a><a class="post-category post-category-JavaScript" href="http://localhost:1313//categories/javascript">JavaScript</a><a class="post-category post-category-ES6" href="http://localhost:1313//categories/es6">ES6</a><a class="post-category post-category-Parse" href="http://localhost:1313//categories/parse">Parse</a><a class="post-category post-category-Node.js" href="http://localhost:1313//categories/node.js">Node.js</a><a class="post-category post-category-npm" href="http://localhost:1313//categories/npm">npm</a>
                            
                        </p>
                    </header>

                    <div class="post-description">
                        

<h2 id="a-practical-guide-to-the-growth-mindset:ae2e17d81343b352e5f8570697d79589">A practical guide to the growth mindset</h2>

<p>The Playbook is a webapp I worked on for <a href="http://pomegranatelab.com/">Pomegranate Lab</a>. Its purpose is to enable teachers studying the <a href="http://mindsetonline.com/whatisit/about/">Growth Mindset</a> to find and shard Growth Mindset-based lesson content. The Playbook had the following set of requirements:</p>

<ul>
<li>create a landing page explaining the Growth Mindset</li>
<li>allow teachers to create an account</li>
<li>allow teachers to submit &ldquo;Plays&rdquo;, which are essentially lesson plans targeting specific Growth Mindset elements</li>
<li>plays need to be search-able by teachers, either through full-text search or a variety of categories</li>
<li>enable teachers to add Plays to their &ldquo;Playbook&rdquo; for quick access later</li>
<li>allow admins to curate the front-page content, approve Plays, and add new users</li>
</ul>

<h2 id="back-ends-with-parse:ae2e17d81343b352e5f8570697d79589">Back ends with Parse</h2>

<p>Pomegranate Lab wanted to use the Playbook for its Growth Mindset coaching sessions, so development needed to begin quickly. Due to the expedited nature of the project, I decided to use <a href="https://www.parse.com/">Parse</a> to cut out a majority of the work in back end development. According to Parse&rsquo;s documentation: &ldquo;<a href="https://www.parse.com/docs/js/guide#getting-started">Our goal is to totally eliminate the need for writing server code or maintaining servers</a>&rdquo;.</p>

<p>Database tables, user authentication/permissions, emails, and hosting are all set up using the Parse configuration console. In the rare case you do need to do something special for your back end, Parse has &ldquo;Cloud Code&rdquo; functions. Cloud Code is, in reality, just a node.js environment to run your code on Parse servers. Parse provides libraries for several platforms and/or languages that allow you to interact with your app&rsquo;s &ldquo;back end&rdquo;. Parse also had support for React, which will come into play later.</p>

<p>Setting up all tables (or classes as Parse calls them) and their relations was a snap. Add/dropping columns only took a few clicks, which enabled me to quickly build and iterate on The Playbook&rsquo;s various features. Data permissions are set by assigning user roles and then giving those roles <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> permissions for different data classes.</p>

<h2 id="using-react-for-an-easy-to-understand-ui:ae2e17d81343b352e5f8570697d79589">Using React for an easy to understand UI</h2>

<p>To build the front end, I decided to use a library I had been hearing a lot about called <a href="https://facebook.github.io/react/">React</a>. React is &ldquo;<a href="https://facebook.github.io/react/">A JavaScript library for building user interfaces</a>&rdquo; created by Facebook. It encourages you to separate UI functionality into small pieces called &lsquo;components&rsquo;. Components take application state as parameters and returns what should be displayed. Since code is separated into units usually focused around a single functionality, components are very easy to test and human readable. For example the code to display The Playbook&rsquo;s collapsible menu is:</p>

<pre><code>&lt;SlideMenu&gt;
  &lt;MenuItems&gt;&lt;/MenuItems&gt;
  &lt;MenuPanel&gt;{this.props.children}&lt;/MenuPanel&gt;
&lt;/SlideMenu&gt;
</code></pre>

<p>Which renders as the following:</p>

<p><img src="/img/menu-demo.gif" alt="Menu Image" /></p>

<p>This kind of logical project structure and readability was something I dreamed about when working on other projects.</p>

<h2 id="es6-bringing-javascript-development-to-the-21st-century:ae2e17d81343b352e5f8570697d79589">ES6 bringing JavaScript development to the 21st century</h2>

<p>Unfortunately most browsers do not support the newest JavaScript functionality out of the box, and there are same <a href="https://github.com/lukehoban/es6features">great improvements</a> coming in future versions of JavaScript. For example a simple function to add 5 to a number might look like this in the current version of JavaScript:</p>

<pre><code>function addFive(num) {
  return num + 5;
}
</code></pre>

<p>But with the newer versions of JavaScript, the code could be condensed down into something more readable like:</p>

<pre><code>let addFive = (num) =&gt; num + 5;
</code></pre>

<p>With this in mind, I decided to use the <a href="https://babeljs.io/">Babel</a> transpiler to write the front end code in ES6 JavaScript. Babel takes your ES6 JavaScript code and converts it into ES5 (the current standard) JavaScript that browsers today expect. This let me use modern JavaScript features such as promises, lambdas, and classes in the development of The Playbook.</p>

<h2 id="putting-it-all-together-with-webpack:ae2e17d81343b352e5f8570697d79589">Putting it all together with webpack</h2>

<p>Building a single page webapp with JavaScript is a bit different that building a traditional webapp. You have lots of small (mostly js) files that cause pages to load slowly, since it starts a new request for each file. Ideally you could combine files of similar types during your build process and make your webapp load much faster. This is where webpack comes in.</p>

<p><a href="https://webpack.github.io/">webpack</a> is a module bundler that bundles all your webapp&rsquo;s files and condenses them into static files for easy hosting. JavaScript is concatenated and minified (most whitespace and newlines are removed) into a single js file that is loaded by a main.html file. webpack also gives you the ability to install npm libraries as project dependencies and use them in your front end. It also plays well with font end only libraries, React and Parse in our case, trimming unused code and shrinking your overall project size.</p>

<p>Configuring webpack can be a bit of a challenge the first time, but once set up the build process for The Playbook was very simple:</p>

<ul>
<li>Run webpack</li>
<li>Upload output files to Parse</li>
<li>You&rsquo;re done!</li>
</ul>

<p><a href="https://playbook.parseapp.com">The Playbook</a> is still in use, however, it is in closed beta for teachers.</p>

                    </div>
                </section>
                
            </div>
            

            <div class="footer">
    <div class="pure-menu pure-menu-horizontal pure-menu-open">
        <ul>
            <li>Powered by <a class="hugo" href="http://hugo.spf13.com/" target="_blank">hugo</a></li>
        </ul>
    </div>
</div>
<script src="http://localhost:1313//js/all.min.js"></script>
        </div>
    </div>
</div>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', '', 'auto');
ga('send', 'pageview');

</script>

<script data-no-instant>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>
